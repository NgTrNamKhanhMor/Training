<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .calculator-container {
            max-width: 400px;
            margin: 0 auto;
        }
        .display {
            font-size: 1.5em;
        }
        .button {
            height: 60px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        .operator {
            background-color: #f0f0f0;
        }
        .operator:hover {
            background-color: #e0e0e0;
        }
        .equal {
            background-color: #1976d2;
            color: white;
        }
        .equal:hover {
            background-color: #1565c0;
        }
        #display{
            width: 100%;
            height: 50px;
        }
    </style>
</head>
<body>
    <div class="container px-4 px-lg-5 text-bg-dark h-100 my-4 calculator-container">
        <div class="row ">
            <div class="col-12 text-bg-light text-center p-0">
                <div class="w-100 display text-center p-2 border-0" id="display"></div>
            </div>
        </div>
        <div class="row ">
            <div class="col-3 button c text-bg-light border" data-value="C">C</div>
            <div class="col-3 button sqrt text-bg-light operator border" data-value="sqrt">&radic;</div>
            <div class="col-3 button text-bg-light operator border" data-value="square">x<sup>2</sup></div>
            <div class="col-3 button op text-bg-light operator border" data-value="+">+</div>


        </div>
        <div class="row ">
            <div class="col-3 button num text-bg-light operator border" data-value="7">7</div>
            <div class="col-3 button num text-bg-light operator border" data-value="8">8</div>
            <div class="col-3 button num text-bg-light operator border" data-value="9">9</div>
            <div class="col-3 button op text-bg-light operator border" data-value="-">-</div>
        </div>
        <div class="row ">
            <div class="col-3 button num text-bg-light operator border" data-value="4">4</div>
            <div class="col-3 button num text-bg-light operator border" data-value="5">5</div>
            <div class="col-3 button num text-bg-light operator border" data-value="6">6</div>
            <div class="col-3 button op text-bg-light operator border" data-value="*">x</div>

        </div>
        <div class="row ">
            <div class="col-3 button num text-bg-light operator border" data-value="1">1</div>
            <div class="col-3 button num text-bg-light operator border" data-value="2">2</div>
            <div class="col-3 button num text-bg-light operator border" data-value="3">3</div>
            <div class="col-3 button op text-bg-light operator border" data-value="/">/</div>
        </div>
        <div class="row ">
            <div class="col-3 button text-bg-light operator border" data-value="bracket">()</div>

            <div class="col-3 button num text-bg-light border" data-value="0">0</div>
            <div class="col-3 button num text-bg-light operator border" data-value=".">.</div>
            <div class="col-3 button equal border" data-value="=">=</div>
        </div>
    </div>
    <script>
        const display = $("#display");
        let calValue = "";
        const brackets = [];
        let displayValue = $(this).attr("data-value");

        $(document).ready(function(){
            $(".num").click(function(){
                const displayValue = $(this).attr("data-value")
                calValue += displayValue
                display.html(display.html() + displayValue)
            })
            $(".op").click(function(){
                const displayValue = $(this).attr("data-value");
                const lastChar = calValue.slice(-1);
                if (calValue === "" && displayValue !== '-') {
                    return;
                }
                else if (['+', '-', '*', '/'].includes(lastChar)) {
                    calValue = calValue.slice(0, -1) + displayValue;
                    display.html(display.html().slice(0,-1) + displayValue);
                }
                else if (lastChar === '('){
                    return;
                }
                else {
                    calValue += displayValue;
                    display.html(display.html() + displayValue)
                }
            })
            $(".equal").click(function(){
                let displayValue = $(this).attr("data-value");
                if(calValue ==""){
                    return;
                }
                if (brackets.length != 0) {
                    for (let i = 0; i < brackets.length; i++) {
                        calValue += ")";
                    }
                }
                const result = String(eval(calValue))
                calValue = result 
                brackets.length = 0;
                displayValue = result
                display.html(displayValue);
            })
            $(".c").click(function(){
                let displayValue = $(this).attr("data-value");
                calValue = ""
                displayValue = ""
                brackets.length = 0;
                display.html("");
            })
            $(".sqrt").click(function(){
                let displayValue = "&radic;("
                let lastNumberMatch = calValue.match(/(\d+\.?\d*)$/);
                
                if (lastNumberMatch) {
                    displayValue = "*" + displayValue;
                    calValue = calValue+'*';
                }
                calValue += "Math.sqrt(";
                brackets.push("(")
                display.html(display.html()+displayValue)
            })


            
        });
    </script>
</body>
</html>